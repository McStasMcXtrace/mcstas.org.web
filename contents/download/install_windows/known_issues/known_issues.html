<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
  <title>McStas Windows installation instructions</title>
</head>
<body>
<h1>Installing McStas 2.1 on Windows<br>
</h1>
<b>See bottom of page for known issues for this platform.</b>
<br>
<h4><font color="#3366ff">Windows</font></h4>
<ul>
  <li>Download and install the McStas Windows metapackage
  corresponding to your system - 32 or 64bit. Screenshots of the
  installation process are available below.
  (NOTE: we recommend to
  always use the 32bit version as the 64 bit version of the GNU gcc
  compiler has issues on windows!)
  <li>The package contains:
  <ul>
    <li><b>Strawberry Perl 5.18</b>, also including the gcc
    compiler. <b>IMPORTANT:</b> Please uninstall any older version of
    Perl before attempting to install the McStas bundle!
    <li>McStas-specific extensions to Perl 5.18
    <li>McStas code generator, components, instruments and datafiles
    <li>The "classic" McStas perl tools
    <li>PGPLOT and Gnuplot graphical backends for mcplot/mcdisplay
    <li>A selection of complementary Python tools (optional use), for which you need
    to install the dependencies below.
  </ul>
  <li>Optional Pyhton dependencies:
  <ul>
    <li>Download and install <a
    href="http://code.google.com/p/pythonxy/">Python(x,y)</a>.</li>
  </ul>
  <li>Optionally install  <a href="http://ifit.mccode.org">iFit</a> to visualize results using a Matlab environment (for free, no license needed).</li>
  <li>Optionally install a VRML/X3D plotter such as <a href="http://freewrl.sourceforge.net/">Freewrl</a> or <a href="http://www.instantreality.org/">InstantReality</a>.</li>
  <li>Optionally, you can install the <a href="http://www.nexusformat.org/">NeXus format</a> libraries to be able to export data files in HDF5.</li>
</ul>
<p>The Windows installation bundle has no configurable options and
defaults to install McStas in <pre>c:\mcstas-2.1\</pre> Start it after
installation by using the desktop links mcstas-2.1-shell and mcgui-2.1.
<h2>Installation screenshots</h2>
<p><b>Starting the installation:</b><br><img width="512" src="VMwareFusionScreenSnapz001.png">
<p><b>Dependency overview:</b><br><img width="512" src="VMwareFusionScreenSnapz002.png">
<p><b>Installation go:</b><br><img width="512" src="VMwareFusionScreenSnapz003.png">
<p><b>Extracting files:</b><br><img width="512" src="VMwareFusionScreenSnapz004.png">
<p><b>Starting Perl installation (not needed if Perl 5.18 is already
installed - but please remove any OLDER version of Perl before
starting this install):</b><br><img width="512" src="VMwareFusionScreenSnapz009.png">
<p><b>Accept Perl license:</b><br><img width="512" src="VMwareFusionScreenSnapz010.png">
<p><b>Perl directory location:</b><br><img width="512" src="VMwareFusionScreenSnapz011.png">
<p><b>Perl installation go:</b><br><img width="512" src="VMwareFusionScreenSnapz012.png">
<p><b>Install process:</b><br><img width="512" src="VMwareFusionScreenSnapz013.png">
<p><b>Finishing Perl install (no need to view the README file):</b><br><img width="512" src="VMwareFusionScreenSnapz014.png">
<p><b>Unpacking and installing Perl extensions (two terminal windows
may appear):</b><br><img width="512" src="VMwareFusionScreenSnapz005.png">
<p>Completing installation:<b></b><br><img width="512" src="VMwareFusionScreenSnapz007.png">
<p><b>After installation two Desktop shortcuts should appear (You MUST
use these to start the installed version of McStas as McStas is not
installed on the Window system PATH):</b><br><img src="VMwareFusionScreenSnapz008.png">

<p>Please report any trouble in using these instructions to <a
href="mailto:mcstas-users@mcstas.org">mcstas-users@mcstas.org</a>.

<h2>Known issues for the Windows platform:</h2>
<ul>
  <li>You will have issues with Perl if <b>more than one</b> version
  of Perl is installed at the same time. Please
  <ul>
    <li>Use the windows add/remove software tool to remove any older
    version of Perl <b>before</b> installing a new McStas
    <li>Please fully remove both of the folders c:\perl and
    c:\strawberry <b>before</b> installing a new McStas
  </ul>
  <li>Our tool set <b>does not fully support</b> working directories
  including <b>spaces or other non-ascii characters</b>. If you have an older Windows system with a user
  account in c:\Documents and Settings we advice you to create and use
  a working directory on the root of the drive e.g. c:\McStaswork
  <li>We suggest to use our 32bit package for windows 64 also, since we feel the 64-bin gcc on
  windows is not mature - gives problems in a few, specific cases. In any case, the 32-bit
  McStas for windows works perfectly fine on a 64-bit operating system!
  <li><b>If you are not able to start any simulation from mcgui</b> - only
  getting back the mcrun --help or the text "press any key to
  continue", your Perl is likely not registered access all commandline
  parameters. This can be remedied by
  <ul>
    <li>Starting the regedit.exe program
    <li>Searching for keys with content C:\strawberry\perl\bin\perl.exe
    <li>Ensure that any entry like that includes a final %* like this:<br>HKEY_CLASSES_ROOT\Applications\perl.exe\shell\open\command = "C:\strawberry\perl\bin\perl.exe" "%1" %*
  </ul>
  <li>If you <b>experience strange behavior from perl/mcgui</b> on Windows like
       	    <ol>
	      <li>ppm shell not being able to install the extra Perl
	      packages, i.e. no Tk module on the Perl PATH
	      <li>mcgui not being able to run / compile a simulation (all you get is mcrun -- help output)
	      <li>mcgui not being able to access local component files
	  </ol>
	  <li>- Then the solution can be to ensure your user has "full control" to the executables in
	  c:\strawberry\perl\bin (Right-click the folder, Properties, Security, Authenticated users -> Edit)
</ul>
<address></address>
<!-- hhmts start -->Last modified: Tue Apr  8 09:38:13 CEST 2014 <!-- hhmts end -->
</body> </html>