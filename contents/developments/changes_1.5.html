<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR"
 content="Mozilla/4.77 [en] (X11; U; Linux 2.2.19 i686) [Netscape]">
  <title>McStas 1.5: Changes</title>
</head>
<body alink="#ff0000" bgcolor="#ffffff" link="#0000ef" text="#000000"
 vlink="#51188e">
<h3>
Changes in version 1.5 (October, 10th, 2001)<br>
</h3>
<ul>
  <li>
Modified components</li>
  <ul>
    <li>
A corrected version of <b>Arm.comp</b>. For further information, see
the
emails by <a href="/neutron-mc/arch/0104/msg00009.html">Ulrich
Wildgruber</a>
and <a href="/neutron-mc/arch/0104/msg00010.html">Stuart Rycroft</a>. <i>(Apr.
26, 2001)</i></li>
    <li>
A corrected version of&nbsp; <b>Monitor_nD.comp</b>. For further
information,
see the email by <a href="/neutron-mc/arch/0104/msg00008.html">Emmanuel
Farhi</a>. <i>(Apr. 26, 2001)</i></li>
    <li>
A rewritten version of <b>Gravity_guide.comp</b> has been contributed
by
Emmanuel Farhi (see <a href="/neutron-mc/arch/0108/msg00000.html">email</a>).
The component provided in the email works with McStas 1.4.2, but the
official
version of the component is not working with McStas 1.4.2 because
support
for this component has been added to the kernel. <i>(Aug. 7, 2001)</i></li>
    <li>
An updated version of <b>Monitor_nD.comp</b> has been contributed by
Emmanuel
Farhi (see <a href="/neutron-mc/arch/0107/msg00002.html">first</a> and
      <a href="/neutron-mc/arch/0108/msg00000.html">second</a>
email). The new version of the component is not working with McStas
1.4.2
because support for the component has been added to the kernel. <i>(Aug.
8, 2001)</i></li>
    <li>
Andrew Wildes and Emmanuel Farhi have detected an error when using
focusing
geometry in <b>Channeled_guide</b>. The slope of the channels is not
computed
corrected correctly, because the same left and right slopes are used in
all channels. This has now been included properly in <b>Gravity_guide</b>,
and it is recommended that this component is used. <i>(Sep. 18, 2001)</i></li>
    <li>
The handling of illumination in <b>Source_flat</b>, <b>Source_div</b>
and
      <b>Source_flat_lambda</b>
have been corrected.
      <i>(Oct. 9, 2001)</i></li>
  </ul>
  <li>
New components</li>
  <ul>
    <li>
The <b>He3_cell.comp</b> has been contributed by Trefor Roberts. It
models
a cylindrical <sup>3</sup>He spin filter cell. <i>(Aug. 8, 2001)</i></li>
    <li>
The <b>Mon_2foc.comp</b> has been contributed by Peter Link. It models
a double bent monochromator with multiple slabs. <i>(Aug. 9, 2001)</i></li>
    <li>
The <b>Bender.comp</b> has been contributed by Philipp Bernhardt. It
models
a curved neutron guide. <i>(Aug. 10, 2001)</i></li>
    <li>
The <b>Powder_filter.comp</b> has been contributed by Ben Fortescue.
It
models a general box-shaped powder filter. <i>(Aug. 16, 2001)</i></li>
    <li>
The <b>Source_Maxwell_3</b> component describes a source with three
Maxwellian
distributions. <i>(Sep. 17, 2001)</i></li>
    <li>
Various monitors have been added: <b>EPSD_monitor</b>, <b>PSDcyl_monitor</b>,
      <b>PSDlin_monitor</b>,
      <b>TOF_cylPSD_monitor</b>,
      <b>TOFlog_mon</b>.
      <i>(Sep.
18, 2001)</i></li>
    <ul>
      <li>
A minor error in <b>TOF_cylPSD_monitor </b>has been corrected. <i>(Oct.
9, 2001)</i></li>
    </ul>
    <li>
A new monitor <b>TOFLambda_monitor</b> has been added. <i>(Oct. 9,
2001)</i></li>
    <li>
A guide modeling waviness, <b>Guide_wavy</b>, has been added. <i>(Oct.
9, 2001)</i></li>
    <li>
A generic source, <b>Source_gen</b>, has been added. <i>(Oct. 10,
2001)</i></li>
  </ul>
  <li>
The signal handling system has been updated to handle a special case.
The
signal handling system will be documented in the manual of version 1.5.
    <i>(Aug.
7, 2001)</i></li>
  <li>
The representation of polarisation in McStas components and instruments
is supposed to work as follows. Only components actually modifying the
spin explicitly require the "POLARISATION PARAMETERS (sx,sy,sz)" line.
An instrument handling polarisation may consist of&nbsp; components
both
with and without this line; it will transform the spin vector correctly
anyway. The&nbsp; "POLARISATION PARAMETERS (sx,sy,sz)" line is
therefore
removed from all official components not dealing with polarisation. The
reason is that for instruments without polarisation some simulation
time
is gained by excluding the transformations of the spin vector. <i>(Aug.
9, 2001)</i></li>
  <li>
Some definitions have been added that can be used in coding components:</li>
  <ul>
    <li>
      <b>NAME_CURRENT_COMP</b> gives the name of the current component
as a string.
      <i>(Aug.
16, 2001)</i></li>
    <li>
      <b>POS_A_CURRENT_COMP</b> gives the absolute position of the
current component.
A component of the vector is referred to as <b>POS_A_CURRENT_COMP.i </b>where<i>
i</i> is <i>x</i>, <i>y</i> or <i>z</i>. <i>(Aug. 16, 2001)</i></li>
    <li>
      <b>ROT_A_CURRENT_COMP </b>and&nbsp; <b>ROT_R_CURRENT_COMP </b>give
the
orientation of the current component as rotation matrices (absolute
orientation
and the orientation relative to the previous component, respectively).
A component of&nbsp; a rotation matrice is referred to as&nbsp; <b>ROT_A_CURRENT_COMP[m][n]</b>,
where <i>m </i>and <i>n</i> are 0, 1, or 2. <i>(Aug. 16, 2001)</i></li>
    <li>
      <b>POS_A_COMP(comp) </b>gives the absolute position of the
component with
the name <i>comp</i>. Note that <i>comp</i> is not given as a string.
A
component of the vector is referred to as <b>POS_A_COMP(comp).i </b>where<i>
i</i> is <i>x</i>, <i>y</i> or <i>z</i>. <i>(Aug. 16, 2001)</i></li>
    <li>
      <b>ROT_A_COMP(comp) </b>and <b>ROT_R_COMP(comp)&nbsp; </b>give
the orientation
of the component <i>comp</i> as rotation matrices (absolute
orientation
and the orientation relative to its previous component, respectively).
Note that <i>comp</i> is not given as a string. A component of&nbsp; a
rotation matrice is referred to as&nbsp; <b>ROT_A_COMP(comp)[m][n]</b>,
where <i>m </i>and <i>n</i> are 0, 1, or 2. <i>(Aug. 16, 2001)</i></li>
  </ul>
</ul>
<h4>
Extensions and updates included in version 1.4.2</h4>
<ul>
  <li>
A three-component representation of the spin is supported and the
polarisation
state vector has been added to all components available in the McStas
release
(which is <i>not</i> equivalent to the McDoc webpage). However, no
components
actually using polarisation are available in this version. For users
writing
components, an additional line "POLARISATION PARAMETERS (sx,sy,sz)" has
to be added to the component preferrably after the "STATE PARAMETERS"
line.
Full documentation will be given in version 1.5.&nbsp; <i>(Apr. 6,
2001)</i></li>
  <ul>
    <li>
See note above from <i>Aug. 9, 2001</i></li>
  </ul>
  <li>
An updated version of <b>Monitor_nD.comp</b> has been provided by
Emmanuel
Farhi. <i>(Apr. 5, 2001)</i></li>
</ul>
<h4>
Extensions and updates included in version 1.4.1</h4>
<ul>
  <li>
An updated version of <b>Monitor_nD.comp</b>&nbsp; has been provided
by
Emmanuel Farhi. Support for monitoring correlations has been included
that
requires the new component <b>PreMonitor_nD.comp</b>. For further
information,
see the <a href="/neutron-mc/arch/0102/msg00010.html">email by Emmanuel</a>.
    <i>(Feb.
19, 2001)</i></li>
  <li>
Corrected versions of <b>Monitor_nD.comp</b>, <b>Monitor_Optimizer.comp</b>
and <b>Source_Optimizer.comp</b> have been provided by Emmanuel Farhi
(they
have been available at the ILL page for a while).
    <i>(Feb. 19, 2001)</i></li>
  <li>
Generic long- and short-pulse components, <b>ESS_moderator_long.comp</b>
and <b>ESS_moderator_short.comp</b>, have been developed by Kim
Lefmann.
The components cover all target station/moderator combinations
currently
discussed by the ESS Instrumentation Group. <i>(Feb. 23, 2001)</i></li>
  <li>
The declaration of the counter of simulation steps <b>run_num </b>has
been
changed from <b>int</b> to <b>double</b>. This should (at least
partly)
solve the problem regarding that the maximum number of simulation steps
is limited by the maximum number that can be used for an <b>int</b> in
C. <i>(Mar. 13, 2001)</i></li>
  <li>
A signal handler has been provided by Emmanuel Farhi. For further
information,
see the <a href="/neutron-mc/arch/0103/msg00004.html">email by Emmanuel</a>.
Consequently, the name of the variable <b>run_num</b> discussed in the
previous entry has been changed to <b>mcrun_num</b>. <i>(Mar. 13,
2001)</i></li>
  <li>
A new component <b>Source_Maxwell.comp</b> and updated versions of <b>Monitor_nD.comp</b>,
    <b>PreMonitor_nD.comp</b>,
and <b>Source_Optimizer.comp</b> have been provided by Emmanuel Farhi.
    <i>(Mar.
14, 2001)</i></li>
  <li>
The update required for correctly handling string parameters in
instruments
pointed out by Emmanuel Farhi is included. For further information, see
the <a href="/neutron_mc/arch/0008/msg00002.html">email by Emmanuel</a>.
    <i>(Mar.
14, 2001)</i></li>
  <li>
An updated version of <b>Gravity_guide.comp</b> has been provided by
Kim
Lefmann correcting the errors concerning the protection of variables. <b>Gravity_guide.comp</b>
has previously been an unofficial component, but is now included in the
official version. <i>(Mar. 15, 2001)</i></li>
  <li>
The maximum number of lines in a component has been changed to 5000 by
modifying MAX_ELEMENTS in <b>list.c</b>, which of course only partly
solves
the problem. <i>(Mar. 15, 2001)</i></li>
</ul>
<hr width="100%">
<center><i>Last modified October 31, 2001 by Per-Olof &Aring;strand</i></center>
</body>
</html>
