<H1>McDoc, automatic documentation generation for McStas
	components.</H1>

The <A HREF="/download/components/">documentation on McStas components</A> is
      generated automatically from comments inside the component
      definition source files. This greatly increases the hope of
      keeping the documentation up-to-date with the code.

<P>
McDoc is included in McStas from version 1.3 on. Users contributing
components are encouraged to use the McDoc comment format.

<H2>Documentation on McDoc</H2>

<P>
The McDoc tool in McStas is used to automatically generate documentation
in various forms for components. The documentation is generated from the
source code of the components. Specially formated comments in the
component header are parsed to provide additional information. By using
the source code itself as the source of documentation, the documentation
is much more likely to be a faithful and up-to-date description of how
the component actually works.

<H3>The format of the comment header in the components</H3>

<P>
The format is mostly straight-forward, and is designed to be easily
readable both by humans and by automatic tools like McDoc. McStas has
been written to be quite tolerant in terms of how the comments may be
formatted and broken across lines. A good way to get a feel for the
format is to study some of the examples in the various components on the
McStas home page (http://neutron.risoe.dk/mcstas/). Below appear a few
notes on the requirements for the comment headers:

<P>
The comment syntax uses %IDENTIFICATION, %DESCRIPTION, %PARAMETERS,
%LINKS, and %END keywords to mark the different sections; keywords may be
abbreviated.

<UL>
  <LI>In the %IDENTIFICATION section, "author:" (or "written by:" for
backwards compatibility) denote author; "date:", "version:", and
"origin:" are also supported. Any number of "Modified by:" entries may
be used to give the revision history. The "author:", "date:",
etc. entries must all be on a single line. Everything else in the
identification section is part of the "short description" of the
component.
  <LI>In the %PARAMETERS section, descriptions have the form
"name: [unit] text" or "name: text [unit]". These may span multiple
lines; subsequent lines must be indented by at least four spaces. Note
that square brackets [] should be used for units. Normal parenthesis are
also supported for backwards compatibility, but nested parenthesis do
not work well.
  <LI>The %DESCRIPTION section contains text in free format. The text may
contain HTML tags like &lt;IMG&gt; (to include pictures) and &lt;A&gt;...&lt;/A&gt; (for
links to other web pages, but see also the %LINK section). In the
generated web documentation pages, the text is set in &lt;PRE&gt;...&lt;/PRE&gt;, so
that the line breaks in the source will be obeyed.
  <LI>Any number of %LINK sections may be given; each one contains HTML
code that will be put in a list item in the link section of the
description web page. This usually consists of an &lt;A HREF="..."&gt; ...
&lt;/A&gt; pointer to some other source of information.
  <LI>After %END, no more header text is parsed.
</UL>

<H2>The synchronisation of several WEB component library mirrors</H2>

<P>
Also implemented is a method for sharing component libraries among
different institutes. A special directory on a web server at each
institute participating is needed (currently only Ris&oslash; and
ILL). This directory contains ONLY the source code for the components to
be shared (ie. the Ris&oslash; directory contains the official
components, the ILL directory contains the rest). A a small shell script
has been written,
<PRE>
    <A HREF="http://neutron.risoe.dk/documentation/mcdoc/src/builddocs.sh">http://neutron.risoe.dk/documentation/mcdoc/src/builddocs.sh</A>
</PRE>
This script automatically downloads the component source codes from each
web server into common subdirectories. It then downloads the newest
mcdoc program from the Ris&oslash; server and re-builds all the
documentation.

<P>
The command
<PRE>
    ./builddocs.sh
</PRE>
will download all components and build the web pages. The method also
works in the presence of firewalls; for example at the ILL it is
necessary to first execute
<PRE>
    setenv http_proxy proxy.ill.fr:8888
</PRE>
To participate, one needs to set up a directory on a web server and keep
it updated with the newest source codes for the components to be
share. This server directory must be added to the builddocs.sh
script. Then all participants use the builddocs.sh script to create a
single component page with all components that are automatically kept
synchronized.

