<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD>
<TITLE>Single_crystal</TITLE>
<LINK REV="made" HREF="mailto:kristian.nielsen@risoe.dk">
</HEAD>

<BODY>

<P ALIGN=CENTER>
 [ <A href="#id">Identification</A>
 | <A href="#desc">Description</A>
 | <A href="#ipar">Input parameters</A>
 | <A href="#opar">Output parameters</A>
 | <A href="#links">Links</A> ]
</P>

<H1>The <CODE>Single_crystal</CODE> component</H1>

Mosaic single crystal with multiple scattering vectors.


<H2><A NAME=id></A>Identification</H2>

<UL>
  <LI> <B>Author:</B> Kristian Nielsen</B>
  <LI> <B>Origin:</B> McStas 1.5</B>
  <LI> <B>Date:</B> December 1999</B>
  <LI> <B>Version:</B> 1.18 </B>
</UL>
<H2><A NAME=desc></A>Description</H2>

<PRE>
Single crystal with mosaic. Delta-D/D option for finite-size effects.
Rectangular geometry. Multiple scattering and secondary extinction included.
The mosaic may EITHER be specified isotropic by setting the mosaic input
parameter, OR anisotropic by setting the mosaic_h, mosaic_v, and mosaic_n
parameters.
Crystal structure is specified with an ascii data file. Each line
contains seven numbers, separated by white space. The first three numbers
are the (h,k,l) indices of the reciprocal lattice point, and the last
number is the value of the structure factor |F|**2, in barns. (The rest of
the numbers are not used; the file is in the format output by the
Crystallographica program).

Example: Single_crystal(xwidth=0.01, yheight=0.01, zthick=0.01,
          delta_d_d=1e-4, mosaic = 5, 
          ax = 3.8186, ay = 0, az = 0,
          bx = 0, by = 3.8843, bz = 0,
          cx = 0, cy = 0, cz = 11.6777
          reflections="YBaCuO.dat")
  Overview of algorithm:

  (1). The neutron intersects the crystal at (x,y,z) with given
       incoming wavevector ki=(kix,kiy,kiz).

  (2). Every reciprocal lattice point tau of magnitude less than 2*ki
       is considered for scattering. The scattering probability is the
       area of the intersection of the Ewald sphere (approximated by
       the tangential plane) with the 3-D Gaussian mosaic of the point
       tau.

  (3). The total coherent scattering cross section is computed as the
       sum over all tau. Together with the absorption and incoherent
       scattering cross section and known potential flight-length
       l_full through the sample, we can compute the probability of
       the four events absorption, coherent scattering, incoherent
       scattering, and transmission.

  (4). Absorption is never simulated explicitly, just incorporated in
       the neutron weight.

  (5). Transmission in the first event is selected with the Monte
       Carlo probability p_transmit, which defaults to the actual
       transmission probability. After the first event, transmission
       is selected with the correct Monte Carlo probability.

  (6). Incoherent scattering is done simply by selecting a random
       direction for the outgoing wave vector kf.

  (7). For coherent scattering, a reciprocal lattice point is selected
       using the relative probabilities computed in (2), and the
       weight is adjusted with the contribution from the structure
       factors (this way all reflections will get equally good
       statistics in the detector).

  (8). The outgoing wave vector direction is picked at random using
       the intersecting 2-D Gauss computed in (2). The vector is
       normalized to the length of ki (elastic scattering) to account
       for the error caused by the planar approximation of the Ewald
       sphere.

  (9). The process is repeated from (2) with kf as new initial wave
       vector ki.

</PRE>

<H2><A NAME=ipar></A>Input parameters</H2>
Parameters in <B>boldface</B> are required;
the others are optional.
<TABLE BORDER=1>
<TR><TH>Name</TH>  <TH>Unit</TH>  <TH>Description</TH> <TH>Default</TH></TR>
<TR> <TD><B>reflections</B></TD>
     <TD>string</TD>
     <TD>File name containing structure factors of reflections </TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>xwidth</B></TD>
     <TD>m</TD>
     <TD>Width of crystal </TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>yheight</B></TD>
     <TD>m</TD>
     <TD>Height of crystal </TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>zthick</B></TD>
     <TD>m</TD>
     <TD>Thichness of crystal (no extinction simulated) </TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD>delta_d_d</TD>
     <TD>1</TD>
     <TD>Lattice spacing variance, gaussian RMS </TD>
<TD ALIGN=RIGHT>1e-4</TD> </TR>
<TR> <TD>mosaic</TD>
     <TD>arc minutes</TD>
     <TD>Crystal mosaic (isotropic), gaussian RMS </TD>
<TD ALIGN=RIGHT>-1</TD> </TR>
<TR> <TD>mosaic_h</TD>
     <TD>arc minutes</TD>
     <TD>Horizontal (rotation around Y) mosaic (anisotropic),
gaussian RMS </TD>
<TD ALIGN=RIGHT>-1</TD> </TR>
<TR> <TD>mosaic_v</TD>
     <TD>arc minutes</TD>
     <TD>Vertical (rotation around Z) mosaic (anisotropic),
gaussian RMS </TD>
<TD ALIGN=RIGHT>-1</TD> </TR>
<TR> <TD>mosaic_n</TD>
     <TD>arc minutes</TD>
     <TD>Out-of-plane (Rotation around X) mosaic (anisotropic),
gaussian RMS </TD>
<TD ALIGN=RIGHT>-1</TD> </TR>
<TR> <TD>ax</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>3.8186</TD> </TR>
<TR> <TD>ay</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>az</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>bx</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>by</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>3.8843</TD> </TR>
<TR> <TD>bz</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>cx</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>cy</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>cz</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>11.6777</TD> </TR>
<TR> <TD>p_transmit</TD>
     <TD>1</TD>
     <TD>Monte Carlo probability for neutrons to be transmitted
without any scattering. Used to improve statistics from
weak reflections </TD>
<TD ALIGN=RIGHT>-1</TD> </TR>
<TR> <TD>absorbtion</TD>
     <TD>barns</TD>
     <TD>Absorbtion cross-section per unit cell at 2200 m/s </TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>incoherent</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>aa</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>bb</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>cc</TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>0</TD> </TR>
</TABLE>


<H2><A NAME=opar></A>Output parameters</H2>
<TABLE BORDER=1>
<TR><TH>Name</TH>  <TH>Unit</TH>  <TH>Description</TH> <TH>Default</TH></TR>
<TR> <TD><B>hkl_info</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
</TABLE>


<H2><A NAME=links></A>Links</H2>

<UL>
  <LI> <A HREF="Single_crystal.comp">Source code</A> for <CODE>Single_crystal.comp</CODE>.
</UL>
<HR>
<P ALIGN=CENTER>
 [ <A href="#id">Identification</A>
 | <A href="#desc">Description</A>
 | <A href="#ipar">Input parameters</A>
 | <A href="#opar">Output parameters</A>
 | <A href="#links">Links</A> ]
</P>

<ADDRESS>
Generated automatically by McDoc, Kristian Nielsen
&lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt; /
Jul 22 2002
</ADDRESS>
</BODY></HTML>
