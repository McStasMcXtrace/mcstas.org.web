<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Soller_trans.comp -->
<!--X-From: "Dr. Georg Artus" <Georg_Artus@Physik.TU&#45;Muenchen.DE> -->
<!--X-Date: Fri, 25 Jun 1999 11:10:42 +0200 -->
<!--X-Message-Id: 37734792.D83D6BB9@ph.tum.de -->
<!--X-ContentType: multipart/mixed -->
<!--X-Reference-Id: 01JCJPKXZQ7C94NTAD@risoe.dk -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Soller_trans.comp</title>
<link rev="made" href="mailto:Georg_Artus@Physik.TU-Muenchen.DE">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00012.html">Date Prev</A>][Date Next]
<a href="index.html#00011">[Chronological]</a>
<a href="threads.html#00011">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Soller_trans.comp</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI><strong>Subject</strong>: <strong>Soller_trans.comp</strong></LI>
<LI><strong>From</strong>: <strong>"Dr. Georg Artus" &lt;<A HREF="mailto:Georg_Artus@Physik.TU-Muenchen.DE">Georg_Artus@Physik.TU-Muenchen.DE</A>&gt;</strong></LI>
<LI>Date: Fri, 25 Jun 1999 11:10:42 +0200</LI>
<LI>Organization: TUM</LI>
<LI>References: &lt;<A HREF="msg00003.html">01JCJPKXZQ7C94NTAD@risoe.dk</A>&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Hello Kristian,

I just modified the component Soller to Soller_trans. The new component
has an additional parameter transmission, which is a general
multiplicator for the transmission probability. The true transmission of
a Soller is not 1 also with a non divergent beam. For calculations of
absolute fluxes this is important.
Because I am not experience with C (I just checked Soller.comp by
mathematical undterstanding) I don´t want to send the new component to
the mailing-list directly. I also didn´t add a check whether the given
parameter ´transmission´ lies between 0 and 1. 
Our tests indicate that the component works correctly. May be you can
have a look at the file.

Georg 
-- 
*********************************************

Dr. Georg Artus
Technische Universitaet Muenchen
Neue Forschungs-Neutronenquelle Garching
D-85747 Garching

Tel: +49 (0)89/289-14675
Fax: +49 (0)89/289-14666 or 12112
E-mail: gartus@ph.tum.de

</PRE>
<PRE>
/*******************************************************************************
*
* McStas, version 1.0, released October 26, 1998
*         Maintained by Kristian Nielsen and Kim Lefmann,
*         Risoe National Laboratory, Roskilde, Denmark
*
* Component: Soller_trans
*
* Written by: KN, August 1998
* Modified by: GA, June 1999
*
* Soller collimator with rectangular opening and specified length. The
* transmission function is an average and does not utilize knowledge of the
* actual neutron trajectory.
* A zero divergence disables collimation (then the component works as a double slit).
* Added is an additional parameter ´transmission´ to take into account the
* transmission probability. 
*
* INPUT PARAMETERS:
*
* xmin:       (m)              Lower x bound on slits
* xmax:       (m)              Upper x bound on slits
* ymin:       (m)              Lower y bound on slits
* ymax:       (m)              Upper y bound on slits
* len:        (m)              Distance between slits
* divergence: (minutes of arc) Divergence angle (calculated as atan(d/len),
*                              where d is the blade spacing) 
* transmission: (1)            0&lt;=transmission&lt;=1)
*
*******************************************************************************/


DEFINE COMPONENT Soller_trans
DEFINITION PARAMETERS (xmin, xmax, ymin, ymax, len, divergence, transmission)
SETTING PARAMETERS ()
OUTPUT PARAMETERS (slope)
STATE PARAMETERS (x,y,z,vx,vy,vz,t,s1,s2,p)
DECLARE
%{
  double slope;
%}
INITIALIZE
%{
  slope = tan(MIN2RAD*divergence);
%}
TRACE
%{
    double phi, dt;
    
    PROP_Z0;
    if (x&lt;xmin || x&gt;xmax || y&lt;ymin || y&gt;ymax)
      ABSORB;
    dt = len/vz;
    PROP_DT(dt);
    if (x&lt;xmin || x&gt;xmax || y&lt;ymin || y&gt;ymax)
      ABSORB;

    if(slope &gt; 0.0)
    {
      phi = fabs(vx/vz);  
      if (phi &gt; slope)   
        ABSORB;
      else
        p *= transmission*(1.0 - phi/slope);
    }
%}

MCDISPLAY
%{
  double x;
  int i;

  magnify("xy");
  for(x = xmin, i = 0; i &lt;= 3; i++, x += (xmax - xmin)/3.0)
    multiline(5, x, (double)ymin, 0.0, x, (double)ymax, 0.0,
              x, (double)ymax, (double)len, x, (double)ymin, (double)len,
              x, (double)ymin, 0.0);
  line(xmin, ymin, 0,   xmax, ymin, 0);
  line(xmin, ymax, 0,   xmax, ymax, 0);
  line(xmin, ymin, len, xmax, ymin, len);
  line(xmin, ymax, len, xmax, ymax, len);
%}

END

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00003" HREF="msg00003.html">Re: flux-sources</A></STRONG>
<UL><LI><EM>From:</EM> Kristian Nielsen &lt;kristian.nielsen@risoe.dk&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00012.html">Vanadium Sample</A></STRONG>
</LI>


<li>Index(es):
<ul>
<li><a href="index.html#00011"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00011"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
