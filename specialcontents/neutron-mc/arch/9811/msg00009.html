<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: MCStas -->
<!--X-From: Andrew Garrett <agarrett@ccbsf0.kek.jp> -->
<!--X-Date: Wed, 11 Nov 1998 06:56:20 +0900 -->
<!--X-Message-Id: 01J48MF1N4SG8WWAUI@risoe.dk -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 01J40DBKDGAY91WAMR@risoe.dk -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: MCStas</title>
<link rev="made" href="mailto:agarrett@ccbsf0.kek.jp">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00013.html">Date Prev</A>][<A HREF="msg00007.html">Date Next</A>]
<a href="index.html#00009">[Chronological]</a>
<a href="threads.html#00009">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: MCStas</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI><strong>Subject</strong>: <strong>Re: MCStas</strong></LI>
<LI><strong>From</strong>: <strong>Andrew Garrett &lt;<A HREF="mailto:agarrett@ccbsf0.kek.jp">agarrett@ccbsf0.kek.jp</A>&gt;</strong></LI>
<LI>Date: Wed, 11 Nov 1998 06:56:20 +0900</LI>
<LI>Content-return: allowed</LI>
<LI>References: &lt;01J40DBKDGAY91WAMR@risoe.dk&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
Kristian,

  Thanks for getting back to me so quickly, I'd like to get this working.  Pity it
wasn't the #line comments, I had high hopes for that being it, since it looked
fairly easy to fix...  One mis-communication, though.  I don't have a compiler
error, the program compiles just fine (under Boorland C++ 4.52, BTW)  I had to
replace the srtcasecmp statements, but can handle alloca without any problems.

  The problem comes when I run the program, calling MCStas with an instrument file -
I'm using linup-1, from your examples directory, renamed linup1.ins to avoid long
name problems.  I get an "illegal operation error" after starting the program,
nothing more specific than that, I'm afraid.  By inserting printf's into the main
program, I've been trying to track down where this occurs.

  In general, but not always, the program gets to the line in main(), 'err =
yyparse();'  I cannot get the program to compile if I put printf's inside yyparse()
though.  When seraching for the component, it does make one call to
try_open_component, and tries to find a file with a .comp extension, but then it
fails after that, without making a second call.

  I'm still working on this, and will keep you informed.  If you've got any ideas,
please let me know.  Thanks,

  Andrew Garrett

&gt; This file is not related to your problem. The #line bit just tells your
&gt; C compiler that the following code was copied from a file of that name,
&gt; so that error messages can refer to the original file. You can safely
&gt; delete all the #line's, but that is unlikely to make any difference.
&gt;
&gt; You do not give much information, perhaps you could send me the exact
&gt; error message of the compiler (and perhaps also information on what
&gt; compiler you are using)?
&gt;
&gt; As far as I know, with Microsoft visual C two problems occur, both in
&gt; the linker phase. One is a missing strcasecmp() function and one is a
&gt; missing alloca() function. I believe you can solve this by replacing
&gt; strcasecmp() with stricmp() (or plain strcmp() if stricmp also does not
&gt; work); and by having the compiler define the preprocessor symbol MSDOS
&gt; (or put the line '#define MSDOS 1' in mcstas.h).
&gt;
&gt; &gt;   As to other changes that have been required, most have revolved around
&gt; &gt; the file system, changing the separator '/' to '\'.  Also, I had to
&gt;
&gt; Yes.
&gt;
&gt; &gt; declare the variable read_components in mcstas.h as extern, or I got an
&gt; &gt; error for this being declared in every file.  I'm not sure if that will
&gt; &gt; cause problems down the road - was that defined anywhere else?
&gt;
&gt; Yes, this is a bug! I have fixed it in my source, it wil be in the next version.
&gt;
&gt; &gt;   Thanks for your help,
&gt;
&gt; You are welcome. Let me know what you find; once we get it working you
&gt; should send me your changes so that the next version of McStas works
&gt; with Windows.
&gt;
&gt;  - Kristian.



</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00013.html">Re: First tries using McStas</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00007.html">Re: MCStas</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00009"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00009"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
