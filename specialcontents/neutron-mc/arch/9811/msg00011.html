<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: Windows McStas -->
<!--X-From: Kristian Nielsen <kristian.nielsen@risoe.dk> -->
<!--X-Date: Thu, 12 Nov 1998 08:41:39 +0100 -->
<!--X-Message-Id: 01J48MFA273G8WWAUI@risoe.dk -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 364A4C0F.95DF1B11@ccbsf0.kek.jp -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Windows McStas</title>
<link rev="made" href="mailto:kristian.nielsen@risoe.dk">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00010.html">Date Prev</A>][<A HREF="msg00014.html">Date Next</A>]
<a href="index.html#00011">[Chronological]</a>
<a href="threads.html#00011">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Windows McStas</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:agarrett@ccbsf0.kek.jp">agarrett@ccbsf0.kek.jp</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: Windows McStas</strong></LI>
<LI><strong>From</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI>Date: Thu, 12 Nov 1998 08:41:39 +0100</LI>
<LI>In-reply-to: &lt;364A4C0F.95DF1B11@ccbsf0.kek.jp&gt;(message from Andrew Garrett on Thu, 12 Nov 1998 11:46:40 +0900)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
&gt;   Thanks for the mail, and the link to the executable.  I couldn't get
&gt; the executable you supplied to run - well, it ran, but it couldn't find
&gt; the components...  But, with the hint you provided about compiling in 32
&gt; bit mode, I did get it to work.  I'm guessing that the version you
&gt; provided was still using forward slashes to separate directories, but
&gt; maybe not...  Anyway, I've got a working version.

The slashes should be ok (at least it worked for us ...). Probably the
MCSTAS environment variable was not set correctly for you? Anyway, you
got a working version, I assume you set the correct path for MC_SYS_DIR
in the source when you fixed the forward/back slashes issue?

&gt;   The output code calls mcparseoptions from mcstas_main.  In
&gt; mcparseoptions, the first command is to allocate memory of 'mcnumipar *
&gt; size...'  I'm not too sure how mcnumipar is set, but when I ran this, it
&gt; was set to 0.  This is a problem, because the very next line checks to
&gt; see if the memory was allocated, and ends the program if it was not.
&gt; And, in DOS/Windows, memory allocation returns NULL if set to a size of
&gt; 0.

Ah, another bug ... thanks for pointing that out. The mcnumipar variable
is set to the number of instrument parameters (the list in
"DEFINE INSTRUMENT name (...)" in the instrument definition). If the
instrument has no parameters, it will be zero as you observed.

&gt;   The simple fix is to change that line to say 'if (paramsetarray ==
&gt; NULL &amp;&amp; mcnumipar != 0)'  Then everything works fine.  I'm just not sure
&gt; where that's written from in the original MCStas.

This code comes from the file "mcstas-r.c" in the "lib"
subdirectory. I will fix this in the next version.

 - Kristian.




</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00010.html">Windows McStas</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00014.html">Re: First tries using McStas</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00011"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00011"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
