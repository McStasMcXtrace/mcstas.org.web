<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: Error in Calculation of absolute Flux (Source_flux) ??? -->
<!--X-From: Kristian Nielsen <kristian.nielsen@risoe.dk> -->
<!--X-Date: 25 Mar 1999 10:38:12 +0100 -->
<!--X-Message-Id:  -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 36F913D5.3EE656E2@ph.tum.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Error in Calculation of absolute Flux (Source_flux) ???</title>
<link rev="made" href="mailto:kristian.nielsen@risoe.dk">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00022.html">Date Prev</A>][<A HREF="msg00025.html">Date Next</A>]
<a href="index.html#00023">[Chronological]</a>
<a href="threads.html#00023">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Error in Calculation of absolute Flux (Source_flux) ???</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:Ralph_Gilles@Physik.TU-Muenchen.DE">Ralph_Gilles@Physik.TU-Muenchen.DE</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: Error in Calculation of absolute Flux (Source_flux) ???</strong></LI>
<LI><strong>From</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI>Date: 25 Mar 1999 10:38:12 +0100</LI>
<LI>In-reply-to: &lt;<A HREF="msg00022.html">36F913D5.3EE656E2@ph.tum.de</A>&gt; (message from Ralph Gilles on Wed,24 Mar 1999 17:33:25 +0100)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
&gt; Hello Kristian,
&gt; 
&gt; thanks for your last answer. I try to implement the sample POWDER1 for a
&gt; structure powder diffractometer.
&gt; 
&gt; Up to the sample everything is o.k. At the detector I received only a few
&gt; neutrons less than 10. I checked the detector and the soller in front of
&gt; detector with a monochromator slab as sample. Both (detector and soller) are
&gt; o.k. I am sure only the sample makes the problem. I increased the struture
&gt; factor but  I am still far away of around 10 the power of six as I expected.
&gt; I took the (300) reflex at 68.422 =B0 in 2 Theta for 1.5469 A-1.

Dear Ralph,

It was nice to see your simulation, it seems that a lot is happening
with McStas in Germany related to the new Munich reactor.

I believe that I found the cause of your problems. As you may have
suspected, it is related to the meaning of the d_phi0 and target_*
parameters for the Powder1 component that you found confusing. That is
admittedly tricky, so I will try a quick explanation. See the web page

  <A HREF="http://elu-alf-2.risoe.dk/~elu-krni/mcstas/components/Powder1/">http://elu-alf-2.risoe.dk/~elu-krni/mcstas/components/Powder1/</A>

for a figure that may be helpful.

The real powder sample scatters neutrons in the full Debye-Scherrer
cone. However that would be wasteful in the simulation since only a
small part of the cone represents directions that may hit the
detector. Thus the Powder1 component permits to select a part of the
Debye-Scherrer cone outside which no neutrons are simulated.

The part of the cone is selected by giving the center position and the
angular width. The width is specified in d_phi0 i degrees, between 0 and
360. This must be sufficiently large to cover the whole of the
detector. The center position is defined by the intersection between the
cone and a plane containing the point of scattering, the position of the
detector (= the target), and the axis of the cone. In effect, this plane
is the scattering plane for the particular sample scattering event.

It is not actually necessary to give the precise position of the target,
any point in the scattering plane will do. That is the reason for the
(1000,0,1000) values you saw in the TAS1 example.

I am aware of the difficulties of this aspect and am working on
improving the documentation and the implementation. Suggestions are
welcome, of course!

Anyway, I fixed the sample focusing in your instrument, and get the
following detector output:

Detector: mon2_I=1.10012e+08 mon2_ERR=1.5974e+06 mon2_N=15226
Detector: psdvm2_I=2.22799e+07 psdvm2_ERR=314281 psdvm2_N=16065
Detector: psdvm3_I=2.11773e+07 psdvm3_ERR=307500 psdvm3_N=15226
Detector: psdvm4_I=2.11773e+07 psdvm4_ERR=307500 psdvm4_N=15226
Detector: divnms2_I=2.0461e+07 divnms2_ERR=302641 divnms2_N=13144
Detector: energ1_I=2.11773e+07 energ1_ERR=307500 energ1_N=15226
Detector: psdp5_I=5614.73 psdp5_ERR=128.712 psdp5_N=6345

which I hope is more reasonable. BTW, I also fixed a potential problem
with some components overlapping (especially detectors). This is
dangerous, as small rounding errors may cause neutrons to be absorbed,
though that appears not to be a problem in your particular case. I am
working on a solution to this problem also.

You may find the fixed instrument definition at URL

  <A HREF="http://neutron.risoe.dk/mcstas/support/gilles/spodi.instr">http://neutron.risoe.dk/mcstas/support/gilles/spodi.instr</A>

Hope this helps,

 - Kristian.




</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00022" HREF="msg00022.html">Re: Error in Calculation of absolute Flux (Source_flux) ???</A></STRONG>
<UL><LI><EM>From:</EM> Ralph Gilles &lt;Ralph_Gilles@Physik.TU-Muenchen.DE&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00022.html">Re: Error in Calculation of absolute Flux (Source_flux) ???</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00025.html">newlines</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00023"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00023"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
