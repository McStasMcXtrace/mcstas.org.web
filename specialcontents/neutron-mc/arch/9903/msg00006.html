<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: cylinder_intersect -->
<!--X-From: Kristian Nielsen <kristian.nielsen@risoe.dk> -->
<!--X-Date: 11 Mar 1999 08:35:32 +0100 -->
<!--X-Message-Id:  -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: v0213050ab30c74c13f76@[193.48.250.126] -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: cylinder_intersect</title>
<link rev="made" href="mailto:kristian.nielsen@risoe.dk">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00005.html">Date Prev</A>][<A HREF="msg00012.html">Date Next</A>]
<a href="index.html#00006">[Chronological]</a>
<a href="threads.html#00006">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: cylinder_intersect</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:hansen@ill.fr">hansen@ill.fr</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: cylinder_intersect</strong></LI>
<LI><strong>From</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI>Date: 11 Mar 1999 08:35:32 +0100</LI>
<LI>In-reply-to: &lt;<A HREF="msg00004.html">v0213050ab30c74c13f76@[193.48.250.126]</A>&gt; (hansen@ill.fr)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
&gt; As 'promised', I've got some trouble with mcstas, trying to put in the
&gt; powder1 sample. In fact, all incoming neutrons are absorbed by the
&gt; condition:
&gt; ...
&gt;   if (cylinder_intersect(&amp;t0, &amp;t1, x, y, z, vx, vy, vz, radius, h))
&gt;   {
&gt;     printf("t0 %lf   t1 %lf \n",t0, t1);
&gt;     if (t0 &lt; 0)
&gt;     {
&gt;       ABSORB;
&gt;     }
&gt; ...
&gt; I checked the neutron parameters, and a typical neutron comes in with:
&gt;  vx=    15 vy=   -29 vz=  2903 m/s
&gt;   x=-0.003  y=-0.014  z= 0.000 m
&gt; The sample is defined as
&gt;  radius 0.020000 height 0.050000 m
&gt; And the routine cylinder_intersect gives finally
&gt;   t0 -0.000007   t1 0.000007

As you mention yourself, the problem is that the neutron is already in
the middle of the sample (z=0) when the sample scattering is computed,
so a negative flight time to the sample surface is computed. Since
neutrons cannot pass backwards in time, McStas absorbs in this case (of
course, it should really provide some warning about this condition; that
will be in a later version).

This kind of problem is usually caused by overlapping components. My
guess is that you have some kind of monitor/detector at the same
physical position as the sample, but before the sample in the logical
ordering. Move the monitor 0.021 cm closer to the monochromator so that
it does not overlap the sample, and I think the problem will be solved.

Good luck with your simulations!

 - Kristian.




</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00004" HREF="msg00004.html">cylinder_intersect</A></STRONG>
<UL><LI><EM>From:</EM> hansen@ill.fr (Thomas Hansen)</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00005.html">mcstas</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00012.html">Re: cylinder_intersect</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00006"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00006"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
