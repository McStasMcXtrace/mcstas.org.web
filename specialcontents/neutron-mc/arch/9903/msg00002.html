<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: order of moving and rotating -->
<!--X-From: Kristian Nielsen <kristian.nielsen@risoe.dk> -->
<!--X-Date: Mon, 22 Mar 1999 14:59:16 +0100 -->
<!--X-Message-Id: 01J94V8JLJBW90Q8JY@risoe.dk -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 36F0FB1D.F5AABF3F@ph.tum.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: order of moving and rotating</title>
<link rev="made" href="mailto:kristian.nielsen@risoe.dk">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00018.html">Date Prev</A>][<A HREF="msg00032.html">Date Next</A>]
<a href="index.html#00002">[Chronological]</a>
<a href="threads.html#00002">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: order of moving and rotating</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:Ralph_Gilles@Physik.TU-Muenchen.DE">Ralph_Gilles@Physik.TU-Muenchen.DE</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: order of moving and rotating</strong></LI>
<LI><strong>From</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI>Date: Mon, 22 Mar 1999 14:59:16 +0100</LI>
<LI>Cc: <A HREF="mailto:neutron-mc@risoe.dk">neutron-mc@risoe.dk</A></LI>
<LI>Date-warning: Date header was inserted by risoe.dk</LI>
<LI>In-reply-to: &lt;<A HREF="msg00020.html">36F0FB1D.F5AABF3F@ph.tum.de</A>&gt;(message from Ralph Gilles on Thu, 18 Mar 1999 14:09:49 +0100)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
&gt; Hello Kristian,
&gt; 
&gt; I am working together with Georg Artus on the program MCSTAS and I am very
&gt; satisfied how it works. Congratulation to you and your colleague.
&gt; 
&gt; I am responsible for the powder diffractometer in munich. Up to now I
&gt; finished simulations from source over neutron guide, monochromator second
&gt; neutron guide, soller collimator and  to the sample.
&gt; 
&gt; Now I would like to include the sample of you (Al2O3) , another soller
&gt; collimator and finally the detector.
&gt; 
&gt; Two questions:
&gt; 
&gt; 1.) Is it possible to save the result at the sample and for scanning the
&gt; Bragg peak only to simulate the part sample to detector with an input file
&gt; =66rom the sample (to save a lot of computing time), because all calculations
&gt; up to the sample are equal if I would like to see a Bragg scan ?
&gt; 
&gt; 2.) Or do you have another idea how to simulate the last part of the
&gt; diffractometer efficiently to see how Bragg peaks look like ?
&gt; 
&gt; greetings, Ralph

We have so far not had the need to simulate only part of an
instrument. All simulations have run sufficiently fast for our purposes,
even when doing the whole instrument.

It would certainly be possible to do what you suggest. A simple way
would be to write a new detector that simply dumps the complete neutron
state to a file (x,y,z,vx,vy,vz,p,t). Essentially just one line:

  fprintf(outfile, "%g %g %g %g %g %g %g %g\n", x,y,z,vx,vy,vz,p,t);

(plus some code to open and close the file). A new source component
would then be written that simply reads this file:

  fscanf(outfile, "%lf %lf %lf %lf %lf %lf %lf %lf\n",
         &amp;x,&amp;y,&amp;z,&amp;vx,&amp;vy,&amp;vz,&amp;p,&amp;t);

(again plus some extra open()/close() code). One must be careful about
the statistics though, since the same random number sequence is now used
for all runs. One could also try to fit the beam profile at the sample
or built a histogram and use that in another source component, but
handling such a multi-dimentional data set could be difficult.

But my advice would be to initially just try and see if the complete
simulation is not fast enough. McStas will generate hundreds of neutron
histories in the time it takes to read a single neutron state from disk.

 - Kristian.





</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00033" HREF="msg00033.html">Thanks!</A></STRONG>
<UL><LI><EM>From:</EM> Philipp Bernhardt &lt;bernhard@amos.krist.uni-erlangen.de&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00025" HREF="msg00025.html">newlines</A></STRONG>
<UL><LI><EM>From:</EM> Farhi &lt;farhi@ill.fr&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00026" HREF="msg00026.html">Re: order of moving and rotating</A></STRONG>
<UL><LI><EM>From:</EM> Farhi &lt;farhi@ill.fr&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00027" HREF="msg00027.html">still searching</A></STRONG>
<UL><LI><EM>From:</EM> Farhi &lt;farhi@ill.fr&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00020" HREF="msg00020.html">Re: order of moving and rotating</A></STRONG>
<UL><LI><EM>From:</EM> Ralph Gilles &lt;Ralph_Gilles@Physik.TU-Muenchen.DE&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00018.html">Re: mcdisplay</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00032.html">velocity selector</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00002"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00002"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
