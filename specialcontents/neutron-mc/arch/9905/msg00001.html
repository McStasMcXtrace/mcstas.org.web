<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: Phase Space Transformation -->
<!--X-From: Kristian Nielsen <kristian.nielsen@risoe.dk> -->
<!--X-Date: 3 May 1999 10:06:58 +0200 -->
<!--X-Message-Id:  -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 37285439.2AC21BD@fz&#45;juelich.de -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Phase Space Transformation</title>
<link rev="made" href="mailto:kristian.nielsen@risoe.dk">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00000.html">Date Prev</A>][<A HREF="msg00002.html">Date Next</A>]
<a href="index.html#00001">[Chronological]</a>
<a href="threads.html#00001">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Phase Space Transformation</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:o.kirstein@fz-juelich.de">o.kirstein@fz-juelich.de</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: Phase Space Transformation</strong></LI>
<LI><strong>From</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;</strong></LI>
<LI>Date: 3 May 1999 10:06:58 +0200</LI>
<LI>In-reply-to: &lt;37285439.2AC21BD@fz-juelich.de&gt; (message from Oliver Kirstein onThu, 29 Apr 1999 14:44:41 +0200)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
&gt; Dear Kristian!
&gt; 
&gt; It's been some time ago since Grenoble but I found some time and tried
&gt; to use the phase space transformation (which is nothing than bragg
&gt; scattering at a moving crystal with a large mosaic). It is based upon

&gt; Abd now the question: Can you crosscheck this routine if you have some
&gt; time to do it? I'm not sure if this would be interesting for anybody,

Thanks for sending me your work on the phase space transformer
component. I am sure that this would be useful for others when it is
finished, especially if you find the time to document it.

Ok, I looked at your code. I haven't completely understood the code, but
I did manage to find a few problems, and by fixing them get some counts
in the detector. The following points should get you going again.

 - When you compute mosaic_h, you use asin(Q/ki_betrag). This should be
asin(Q/2.0/ki_betrag), should it not?

 - There is a problem in your code in that it makes assumptions about
from which direction the neutron is coming (I think). This is partly
inherited from the admittedly not particularly good Monochromator.comp
code. For example, in your test instrument the neutron is actually
intersecting the crystal from behind (v_x &gt; 0), so when you compute G,
you have to make it negative:

    gz_h = -Q * sin(mosaic_h);
    gx_h = -Q * cos(mosaic_h);

 - I do not understand your formula for computing kf. It seems to me
that your code uses kf = 2*g - ki, that should be kf = 2*g + ki, I
think(?).

 - In your instrument, the crystal is at the angle theta=69.2. If the
crystal was stationary, the neutron would be scattered at an angle of
2*theta, with phase transformation it might be something else, but the
detector should be at some other angle than theta, shouldn't it? A good
way to test this is to put a 4PI PSD detector around the PST component.

I put up my modifications to your code on the web server at

    <A HREF="http://neutron.risoe.dk/mcstas/support/kirstein/">http://neutron.risoe.dk/mcstas/support/kirstein/</A>

but the code still needs more modifications.

I hope this helps, please feel free to ask again if you have further
questions.

 - Kristian.




</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00000.html">Re: Windows</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00002.html">Re: velocity selector</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00001"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00001"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
