<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Again: maximum number of events -->
<!--X-From: Kim Lefmann <kim.lefmann@risoe.dk> -->
<!--X-Date: Tue, 06 Mar 2001 09:39:44 +0100 (CET) -->
<!--X-Message-Id: Pine.LNX.3.96.1010306093845.4923C&#45;100000@fys&#45;lin&#45;1.risoe.dk -->
<!--X-ContentType: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Again: maximum number of events</title>
<link rev="made" href="mailto:kim.lefmann@risoe.dk">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00002.html">Date Prev</A>][<A HREF="msg00004.html">Date Next</A>]
<a href="index.html#00003">[Chronological]</a>
<a href="threads.html#00003">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Again: maximum number of events</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:neutron-mc@risoe.dk">neutron-mc@risoe.dk</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Again: maximum number of events</strong></LI>
<LI><strong>From</strong>: <strong>Kim Lefmann &lt;<A HREF="mailto:kim.lefmann@risoe.dk">kim.lefmann@risoe.dk</A>&gt;</strong></LI>
<LI>Date: Tue, 06 Mar 2001 09:39:44 +0100 (CET)</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>


------------------------------
From: Kristian Nielsen &lt;kristian@edlund.dk&gt;
Subject: Re: Again: maximum number of events...
In-reply-to: "Ulrich C. Wildgruber MPI fuer Metallforschung Stuttgart"'s
 message of "Mon, 05 Mar 2001 14:06:27 +0100"
To: neutron-mc@risoe.dk
Message-id: &lt;uofvfmj8k.fsf@edlund.dk&gt;
MIME-version: 1.0
Content-type: text/plain; charset=us-ascii
User-Agent: Gnus/5.0807 (Gnus v5.8.7) Emacs/20.7
Lines: 42
References: &lt;<A HREF="msg00000.html">3AA34FFE.E3B2B252@dxray.mpi-stuttgart.mpg.de</A>&gt;
 &lt;3AA36A49.282C40B@phys.keele.ac.uk&gt;
 &lt;<A HREF="msg00002.html">3AA38F53.22411C9@dxray.mpi-stuttgart.mpg.de</A>&gt;

"Ulrich C. Wildgruber MPI fuer Metallforschung Stuttgart" &lt;wildgrub@dxray.mpi-stuttgart.mpg.de&gt; writes:

&gt; Maybe I misunderstood Kristian's email (I'll look for it and forward it to
&gt; you) or there is something wrong with the way McStas is set up on my
&gt; machine. The behaviour of McStas seems to be compatible with an "long int" 
&gt; counting variable being 32bits on a PC and 64 bits on the ALPHA...
&gt; I guess I'll try to look into the code...

I decided to re-check the source code. The relevant code is in the file
"lib/mcstas-r.c" (some parts deleted for clarity):

    /* Number of neutron histories to simulate. */
    static double mcncount = 1e6;

    /* McStas main() function. */
    int
    mcstas_main(int argc, char *argv[])
    {
      int run_num = 0;
      ^^^

      while(run_num &lt; mcncount)
      {
        mcsetstate(0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1);
        mcraytrace();
        run_num++;
      }

      return 0;
    }

So "mcncount" is a double, as I said before, but the loop counter
"run_num" is an int. This is a bug, the declaration should be changed to

      double run_num = 0;

Without this change, McStas is clearly limited to about 2*10**9
neutrons/run on 32 bit machines. I am mystified as to why this is not
the case on the Alpha (I thought that on Alpha, int was 32 bit and long
was 64, but maybe my memory deceives me).

 - Kristian.



</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00004" HREF="msg00004.html">Re: Again: maximum number of events</A></STRONG>
<UL><LI><EM>From:</EM> Emmanuel Farhi &lt;farhi@ill.fr&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00002.html">Re: Again: maximum number of events...</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00004.html">Re: Again: maximum number of events</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00003"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00003"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
