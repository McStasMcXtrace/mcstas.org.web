<P><strong><blink>This archive web page is obsolete!</blink></strong> 
<P>Please refer to the new <a href="/pipermail/neutron-mc">mailman<a> archive!


<!-- MHonArc v2.1.0 -->
<!--X-Subject: Re: Error in Calculation of absolute Flux (Source_flux) ??? -->
<!--X-From: "Dr. Georg Artus" <Georg_Artus@Physik.TU&#45;Muenchen.DE> -->
<!--X-Date: Mon, 25 Jan 1999 14:56:53 +0000 -->
<!--X-Message-Id: 36AC8635.E6C18FA1@ph.tum.de -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 01J6YCSQWV5E8X7CD8@risoe.dk -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML//EN">
<html>
<head>
<title>Re: Error in Calculation of absolute Flux (Source_flux) ???</title>
<link rev="made" href="mailto:Georg_Artus@Physik.TU-Muenchen.DE">
</head>
<body bgcolor="white">
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<A HREF="msg00018.html">Date Prev</A>][<A HREF="msg00021.html">Date Next</A>]
<a href="index.html#00019">[Chronological]</a>
<a href="threads.html#00019">[Thread]</a>
<a href="/cgi-bin/wilma/neutron-mc">[Top]</a>

<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Error in Calculation of absolute Flux (Source_flux) ???</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong>Kristian Nielsen &lt;<A HREF="mailto:kristian.nielsen@risoe.dk">kristian.nielsen@risoe.dk</A>&gt;, <A HREF="mailto:kim.lefmann@risoe.dk">kim.lefmann@risoe.dk</A>,<A HREF="mailto:Ralph_Gilles@Physik.TU-Muenchen.DE">Ralph_Gilles@Physik.TU-Muenchen.DE</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: Error in Calculation of absolute Flux (Source_flux) ???</strong></LI>
<LI><strong>From</strong>: <strong>"Dr. Georg Artus" &lt;<A HREF="mailto:Georg_Artus@Physik.TU-Muenchen.DE">Georg_Artus@Physik.TU-Muenchen.DE</A>&gt;</strong></LI>
<LI>Date: Mon, 25 Jan 1999 14:56:53 +0000</LI>
<LI>Organization: TUM</LI>
<LI>References: &lt;01J6YCSQWV5E8X7CD8@risoe.dk&gt;</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
hello,

&gt; First we must decide on how "flux" is defined exactly
&gt; 
&gt; You mentioned that in Beamline, the flux is given in the units of
&gt; n/cm**2/AA/s. Now, clearly this value will depend on the position in the
&gt; beam and the wavelength at which it is computed. So now it is I who is
&gt; confused about the units, which seems only fair after the confusion you
&gt; have been through :-)

I'm glad that you haven't lost your sense of humour... :-)
Here is what beamline does:
The user supplies the wavelength limits (from to) in AA and a step size.
E.g. 0.9 1.1 0.1 means simulate the instrument at 0.9AA 1.0AA and 1.1AA.
The step size is also used as delta lambda for each single wavelength to
be calculated. But this value delta lambda is needed only for special
calculations like integrated flux (summed over all calculated
wavelengths) or capture flux (gold foil activation). For calculation of
the flux density at the sample (monitor) it is not needed! E.g. you can
provide 1.0 1.0 0.0 as input and the flux density (n/cm**2/s/AA) is
still computed correctly. This means to me that all neutrons are started
with exactly 1AA. This is physically not meaningful, but for the
calculation of the flux density it is ok because the physics of a
neutron guide doesn't change much in small wavelength ranges ( 0.0xAA).
Also the initial wavelength range doesn't change too much in a guide.
This means that Beamline avoids multiplying and afterwards dividing by a
given wavelength range. This treatment may not be sufficient when you
simulate a more complicated instrument in which the wavelength range is
modified (monochromator) or the absolute wavelengths are modified by any
physical process. 

&gt; I assume that Beamline gives you the average flux in the area under
&gt; consideration (eg. monitor/detector area or perhaps guide exit in
&gt; Beamline?). This makes sense and is easily handled by dividing neutron
&gt; counts with the monitor area.

Yes, it is the flux density averaged over the complete area (of the
monitor or guide exit or sample...)

&gt; But what about the wavelength dependence (as you yourself mention)? Can
&gt; you explain the precise meaning of the Beamline flux numbers you gave,
&gt; 
&gt; &gt; Beamline:   Transmission (%)   Flux at Monitor2 (n/cm**2/AA/s)
&gt; &gt;
&gt; &gt; straight     3.5                 1.75E+09
&gt; &gt; focusing     2.9                 1.82E+09
&gt; 
&gt; in terms of wavelength dependence? More precisely, suppose I have a
&gt; neutron beam that is uniform on a 1 cm**2 area. The wavelength dependent
&gt; flux of the beam is given by a function f such that for a given
&gt; wavelength lambda in AA, the flux of the beam in n/cm**2/AA/s at that
&gt; lambda is f(lambda). Then what is the flux value corresponding to the
&gt; Beamline numbers?

In the end 1/AA in the units of the Beamline output comes from the input
of the source brightness in units of n/cm**2/s/AA/ster. In Beamline the
brightness is calculated from a function brightness(wavelength). I got
this function by fitting the MCNP-data I got for the D2O directly at the
nose of my beamline. 
You can transform the McStas output monitor_I to the Beamline output by
dividing by the monitor area and teh wavelength range (2*dE in AA). It
fits very well! We have tried it with several guides. 

&gt; I can see a couple of possibilities:
&gt; 
&gt; 1. The average flux in a user supplied wavelength range, i.e.
&gt;      (integral(lmin,lmax) f(l) dl) / (lmax - lmin)

That sounds ok! But getting lmax and lmin will be a problem?

&gt; 2. The maximum flux, i.e. the maximum of f (hm, that might be
&gt;    non-trivial to compute from monte carlo data)
&gt; 
&gt; and maybe others, but I would like to know what Beamline does.

&gt; Once we resolve this issue, I will be happy to provide you with a flux
&gt; monitor component for McStas.

I hope this all is not too much trouble! I am glad that I have to think
again about things I thought to be a matter of course. They are not... 

Probably you know already that Ralph Gilles (vis a vis to my desk) and
Peter Link (next door) are starting with McStas!

Best Wishes,

Georg

-- 
*********************************************

Dr. Georg Artus
Technische Universitaet Muenchen
FRM-II Reaktorstation
D-85747 Garching

Tel: +49 (0)89/289-14675
Fax: +49 (0)89/289-14666 or 12112
E-mail: gartus@ph.tum.de


</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00020" HREF="msg00020.html">Re: Error in Calculation of absolute Flux (Source_flux) ???</A></STRONG>
<UL><LI><EM>From:</EM> Kristian Nielsen &lt;kristian.nielsen@risoe.dk&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<LI>Prev by Date:
<STRONG><A HREF="msg00018.html">Re: McStas and W32</A></STRONG>
</LI>

<LI>Next by Date:
<STRONG><A HREF="msg00021.html">Re: McStas and W32</A></STRONG>
</LI>

<li>Index(es):
<ul>
<li><a href="index.html#00019"><strong>Chronological</Strong></a></li>
<li><a href="threads.html#00019"><strong>Thread</strong></a></li>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<!--X-User-Footer-End-->
</BODY>
</HTML>
